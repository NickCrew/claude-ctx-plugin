<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Model Optimization | Claude CTX Plugin</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Model Optimization" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Comprehensive context management plugin for Claude Code" />
<meta property="og:description" content="Comprehensive context management plugin for Claude Code" />
<link rel="canonical" href="https://nickcrew.github.io/claude-ctx-plugin/model-optimization.html" />
<meta property="og:url" content="https://nickcrew.github.io/claude-ctx-plugin/model-optimization.html" />
<meta property="og:site_name" content="Claude CTX Plugin" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Model Optimization" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Comprehensive context management plugin for Claude Code","headline":"Model Optimization","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://nickcrew.github.io/claude-ctx-plugin/assets/images/hero.png"}},"url":"https://nickcrew.github.io/claude-ctx-plugin/model-optimization.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/claude-ctx-plugin/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://nickcrew.github.io/claude-ctx-plugin/feed.xml" title="Claude CTX Plugin" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/claude-ctx-plugin/">Claude CTX Plugin</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/claude-ctx-plugin/">Overview</a><a class="page-link" href="/claude-ctx-plugin/getting-started.html">Getting Started</a><a class="page-link" href="/claude-ctx-plugin/architecture.html">Architecture</a><a class="page-link" href="/claude-ctx-plugin/agents.html">Agents</a><a class="page-link" href="/claude-ctx-plugin/skills.html">Skills</a><a class="page-link" href="/claude-ctx-plugin/model-optimization.html">Model Optimization</a><a class="page-link" href="/claude-ctx-plugin/commands.html">Command Reference</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <h1 id="model-optimization-strategy">Model Optimization Strategy</h1>

<p>Strategic model assignment (Haiku vs Sonnet) for optimal performance and cost efficiency across claude-ctx agents.</p>

<h2 id="overview">Overview</h2>

<p>claude-ctx uses a hybrid model strategy:</p>
<ul>
  <li><strong>Sonnet 4.5</strong>: Complex reasoning, architecture decisions, security analysis</li>
  <li><strong>Haiku 4</strong>: Fast execution, deterministic tasks, code generation</li>
</ul>

<p><strong>Cost Impact</strong>: 40-60% savings on deterministic tasks
<strong>Performance</strong>: 2-5x faster for Haiku-appropriate workloads</p>

<h2 id="model-assignment-criteria">Model Assignment Criteria</h2>

<h3 id="use-sonnet-when">Use Sonnet When:</h3>
<ul>
  <li><strong>Complex reasoning</strong> required (architecture, design decisions)</li>
  <li><strong>Security-critical</strong> analysis (vulnerability assessment, threat modeling)</li>
  <li><strong>Multi-factor evaluation</strong> (code review with architectural patterns)</li>
  <li><strong>Business-critical</strong> decisions (legal, compliance, strategy)</li>
  <li><strong>Novel problem solving</strong> (debugging complex issues, incident response)</li>
  <li><strong>Creative synthesis</strong> (documentation strategy, technical writing)</li>
</ul>

<h3 id="use-haiku-when">Use Haiku When:</h3>
<ul>
  <li><strong>Deterministic execution</strong> (code generation from specs)</li>
  <li><strong>Pattern application</strong> (applying known patterns, scaffolding)</li>
  <li><strong>Test generation</strong> (unit/integration tests following templates)</li>
  <li><strong>Documentation generation</strong> (API docs, code comments)</li>
  <li><strong>Configuration management</strong> (Terraform, Kubernetes manifests)</li>
  <li><strong>Data transformation</strong> (parsing, formatting, validation)</li>
  <li><strong>Repetitive operations</strong> (batch processing, migrations)</li>
</ul>

<h2 id="agent-model-assignments">Agent Model Assignments</h2>

<h3 id="sonnet-agents-complex-reasoning">Sonnet Agents (Complex Reasoning)</h3>

<p><strong>Architecture &amp; Design (11 agents):</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">backend-architect</code> - API and service design decisions</li>
  <li><code class="language-plaintext highlighter-rouge">system-architect</code> - System-level architecture</li>
  <li><code class="language-plaintext highlighter-rouge">cloud-architect</code> - Cloud infrastructure design</li>
  <li><code class="language-plaintext highlighter-rouge">hybrid-cloud-architect</code> - Multi-cloud strategy</li>
  <li><code class="language-plaintext highlighter-rouge">devops-architect</code> - DevOps pipeline design</li>
  <li><code class="language-plaintext highlighter-rouge">frontend-architect</code> - Frontend architecture</li>
  <li><code class="language-plaintext highlighter-rouge">data-architect</code> - Data modeling and governance</li>
  <li><code class="language-plaintext highlighter-rouge">ml-architect</code> - ML system design</li>
  <li><code class="language-plaintext highlighter-rouge">architect-reviewer</code> - Architecture review</li>
  <li><code class="language-plaintext highlighter-rouge">legacy-modernizer</code> - Legacy system redesign</li>
  <li><code class="language-plaintext highlighter-rouge">dx-optimizer</code> - Developer experience strategy</li>
</ul>

<p><strong>Security &amp; Compliance (5 agents):</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">security-auditor</code> - Security vulnerability analysis</li>
  <li><code class="language-plaintext highlighter-rouge">compliance-auditor</code> - Regulatory compliance</li>
  <li><code class="language-plaintext highlighter-rouge">penetration-tester</code> - Security testing strategy</li>
  <li><code class="language-plaintext highlighter-rouge">legal-advisor</code> - Legal review and risk assessment</li>
  <li><code class="language-plaintext highlighter-rouge">privacy-engineer</code> - Privacy compliance</li>
</ul>

<p><strong>Incident &amp; Troubleshooting (4 agents):</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">debugger</code> - Complex debugging and root cause analysis</li>
  <li><code class="language-plaintext highlighter-rouge">incident-responder</code> - Incident coordination and decision-making</li>
  <li><code class="language-plaintext highlighter-rouge">devops-troubleshooter</code> - Production issue diagnosis</li>
  <li><code class="language-plaintext highlighter-rouge">error-coordinator</code> - Error pattern analysis</li>
</ul>

<p><strong>Code Review &amp; Quality (3 agents):</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">code-reviewer</code> - Code review with architectural considerations</li>
  <li><code class="language-plaintext highlighter-rouge">quality-engineer</code> - Quality strategy and test planning</li>
  <li><code class="language-plaintext highlighter-rouge">performance-engineer</code> - Performance optimization strategy</li>
</ul>

<p><strong>Business &amp; Product (4 agents):</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">product-manager</code> - Product strategy and prioritization</li>
  <li><code class="language-plaintext highlighter-rouge">requirements-analyst</code> - Requirements discovery and specification</li>
  <li><code class="language-plaintext highlighter-rouge">business-analyst</code> - Business analysis and insights</li>
  <li><code class="language-plaintext highlighter-rouge">search-specialist</code> - Research and information synthesis</li>
</ul>

<p><strong>Total Sonnet: 27 agents</strong></p>

<hr />

<h3 id="haiku-agents-fast-execution">Haiku Agents (Fast Execution)</h3>

<p><strong>Code Generation (8 agents):</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">python-pro</code> - Python code generation from specs</li>
  <li><code class="language-plaintext highlighter-rouge">typescript-pro</code> - TypeScript code generation</li>
  <li><code class="language-plaintext highlighter-rouge">javascript-pro</code> - JavaScript implementation</li>
  <li><code class="language-plaintext highlighter-rouge">golang-pro</code> - Go implementation</li>
  <li><code class="language-plaintext highlighter-rouge">rust-pro</code> - Rust implementation</li>
  <li><code class="language-plaintext highlighter-rouge">react-specialist</code> - React component generation</li>
  <li><code class="language-plaintext highlighter-rouge">fastapi-pro</code> - FastAPI service generation</li>
  <li><code class="language-plaintext highlighter-rouge">django-pro</code> - Django application generation</li>
</ul>

<p><strong>Testing (3 agents):</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">test-automator</code> - Test generation (pytest, Jest, etc.)</li>
  <li><code class="language-plaintext highlighter-rouge">quality-automator</code> - Automated quality checks</li>
  <li><code class="language-plaintext highlighter-rouge">integration-tester</code> - Integration test generation</li>
</ul>

<p><strong>Infrastructure as Code (4 agents):</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">terraform-specialist</code> - Terraform module generation</li>
  <li><code class="language-plaintext highlighter-rouge">kubernetes-architect</code> - K8s manifest generation</li>
  <li><code class="language-plaintext highlighter-rouge">helm-specialist</code> - Helm chart scaffolding</li>
  <li><code class="language-plaintext highlighter-rouge">ansible-specialist</code> - Ansible playbook generation</li>
</ul>

<p><strong>Documentation (4 agents):</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">docs-architect</code> - Documentation structure (when following template)</li>
  <li><code class="language-plaintext highlighter-rouge">api-documenter</code> - OpenAPI/GraphQL schema generation</li>
  <li><code class="language-plaintext highlighter-rouge">reference-builder</code> - API reference generation</li>
  <li><code class="language-plaintext highlighter-rouge">technical-writer</code> - Technical content (when following style guide)</li>
</ul>

<p><strong>Build &amp; Deployment (4 agents):</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">deployment-engineer</code> - Deployment pipeline execution</li>
  <li><code class="language-plaintext highlighter-rouge">build-engineer</code> - Build optimization (deterministic)</li>
  <li><code class="language-plaintext highlighter-rouge">cli-developer</code> - CLI command implementation</li>
  <li><code class="language-plaintext highlighter-rouge">tooling-engineer</code> - Tool development</li>
</ul>

<p><strong>Data Processing (3 agents):</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">data-engineer</code> - ETL pipeline implementation</li>
  <li><code class="language-plaintext highlighter-rouge">sql-pro</code> - SQL query optimization</li>
  <li><code class="language-plaintext highlighter-rouge">data-validator</code> - Data validation rules</li>
</ul>

<p><strong>Specialized (5 agents):</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">git-workflow-manager</code> - Git operations and workflows</li>
  <li><code class="language-plaintext highlighter-rouge">mermaid-expert</code> - Diagram generation</li>
  <li><code class="language-plaintext highlighter-rouge">electron-pro</code> - Electron app scaffolding</li>
  <li><code class="language-plaintext highlighter-rouge">websocket-engineer</code> - WebSocket implementation</li>
  <li><code class="language-plaintext highlighter-rouge">graphql-specialist</code> - GraphQL schema implementation</li>
</ul>

<p><strong>Total Haiku: 31 agents</strong></p>

<hr />

<h3 id="context-dependent-9-agents">Context-Dependent (9 agents)</h3>

<p>These agents may use either model based on task complexity:</p>

<p><strong>Default Haiku, Escalate to Sonnet:</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">database-optimizer</code> - Query rewriting (Haiku), schema redesign (Sonnet)</li>
  <li><code class="language-plaintext highlighter-rouge">refactoring-expert</code> - Simple refactors (Haiku), architectural refactors (Sonnet)</li>
  <li><code class="language-plaintext highlighter-rouge">workflow-orchestrator</code> - Workflow execution (Haiku), workflow design (Sonnet)</li>
  <li><code class="language-plaintext highlighter-rouge">multi-agent-coordinator</code> - Task routing (Haiku), coordination strategy (Sonnet)</li>
  <li><code class="language-plaintext highlighter-rouge">context-manager</code> - Context extraction (Haiku), context strategy (Sonnet)</li>
</ul>

<p><strong>Default Sonnet, Fast Path to Haiku:</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">learning-guide</code> - Curriculum design (Sonnet), example generation (Haiku)</li>
  <li><code class="language-plaintext highlighter-rouge">tutorial-engineer</code> - Tutorial design (Sonnet), code examples (Haiku)</li>
  <li><code class="language-plaintext highlighter-rouge">socratic-mentor</code> - Question formulation (Sonnet), fact retrieval (Haiku)</li>
  <li><code class="language-plaintext highlighter-rouge">prompt-engineer</code> - Prompt strategy (Sonnet), prompt variations (Haiku)</li>
</ul>

<hr />

<h2 id="hybrid-orchestration-patterns">Hybrid Orchestration Patterns</h2>

<h3 id="pattern-1-design--implement--review">Pattern 1: Design → Implement → Review</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>backend-architect (Sonnet)
  ↓ produces API spec
python-pro (Haiku)
  ↓ implements endpoints
test-automator (Haiku)
  ↓ generates tests
code-reviewer (Sonnet)
  ↓ validates architecture
</code></pre></div></div>

<p><strong>Cost</strong>: 2 Sonnet calls + 2 Haiku calls
<strong>Savings</strong>: 50% vs all-Sonnet</p>

<h3 id="pattern-2-research--generate--validate">Pattern 2: Research → Generate → Validate</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>search-specialist (Sonnet)
  ↓ researches patterns
docs-architect (Haiku)
  ↓ generates documentation
technical-writer (Haiku)
  ↓ polishes content
</code></pre></div></div>

<p><strong>Cost</strong>: 1 Sonnet + 2 Haiku
<strong>Savings</strong>: 67% vs all-Sonnet</p>

<h3 id="pattern-3-troubleshoot--fix--test">Pattern 3: Troubleshoot → Fix → Test</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>debugger (Sonnet)
  ↓ diagnoses root cause
python-pro (Haiku)
  ↓ implements fix
test-automator (Haiku)
  ↓ adds regression tests
</code></pre></div></div>

<p><strong>Cost</strong>: 1 Sonnet + 2 Haiku
<strong>Savings</strong>: 67% vs all-Sonnet</p>

<h3 id="pattern-4-audit--remediate--verify">Pattern 4: Audit → Remediate → Verify</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>security-auditor (Sonnet)
  ↓ identifies vulnerabilities
typescript-pro (Haiku)
  ↓ applies security fixes
quality-engineer (Sonnet)
  ↓ validates remediation
</code></pre></div></div>

<p><strong>Cost</strong>: 2 Sonnet + 1 Haiku
<strong>Savings</strong>: 33% vs all-Sonnet</p>

<hr />

<h2 id="implementation-guidelines">Implementation Guidelines</h2>

<h3 id="agent-frontmatter">Agent Frontmatter</h3>

<p><strong>Sonnet Agents:</strong></p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">model</span><span class="pi">:</span>
  <span class="na">preference</span><span class="pi">:</span> <span class="s">sonnet</span>
  <span class="na">fallbacks</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">haiku</span>
  <span class="na">reasoning</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Complex</span><span class="nv"> </span><span class="s">architectural</span><span class="nv"> </span><span class="s">analysis</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">security</span><span class="nv"> </span><span class="s">evaluation"</span>
</code></pre></div></div>

<p><strong>Haiku Agents:</strong></p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">model</span><span class="pi">:</span>
  <span class="na">preference</span><span class="pi">:</span> <span class="s">haiku</span>
  <span class="na">fallbacks</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">sonnet</span>
  <span class="na">reasoning</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Deterministic</span><span class="nv"> </span><span class="s">code</span><span class="nv"> </span><span class="s">generation</span><span class="nv"> </span><span class="s">from</span><span class="nv"> </span><span class="s">well-defined</span><span class="nv"> </span><span class="s">specifications"</span>
</code></pre></div></div>

<p><strong>Context-Dependent:</strong></p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">model</span><span class="pi">:</span>
  <span class="na">preference</span><span class="pi">:</span> <span class="s">haiku</span>
  <span class="na">escalation</span><span class="pi">:</span>
    <span class="na">to</span><span class="pi">:</span> <span class="s">sonnet</span>
    <span class="na">when</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">architectural</span><span class="nv"> </span><span class="s">refactoring"</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">novel</span><span class="nv"> </span><span class="s">pattern</span><span class="nv"> </span><span class="s">discovery"</span>
      <span class="pi">-</span> <span class="s2">"</span><span class="s">security</span><span class="nv"> </span><span class="s">implications"</span>
  <span class="na">reasoning</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Fast</span><span class="nv"> </span><span class="s">path</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">standard</span><span class="nv"> </span><span class="s">operations,</span><span class="nv"> </span><span class="s">escalate</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">complex</span><span class="nv"> </span><span class="s">decisions"</span>
</code></pre></div></div>

<h3 id="decision-matrix">Decision Matrix</h3>

<table>
  <thead>
    <tr>
      <th>Task Characteristic</th>
      <th>Haiku Score</th>
      <th>Sonnet Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Well-defined spec</td>
      <td>+2</td>
      <td>0</td>
    </tr>
    <tr>
      <td>Novel problem</td>
      <td>0</td>
      <td>+2</td>
    </tr>
    <tr>
      <td>Pattern application</td>
      <td>+2</td>
      <td>0</td>
    </tr>
    <tr>
      <td>Complex reasoning</td>
      <td>0</td>
      <td>+2</td>
    </tr>
    <tr>
      <td>Security critical</td>
      <td>-1</td>
      <td>+2</td>
    </tr>
    <tr>
      <td>Code generation</td>
      <td>+2</td>
      <td>0</td>
    </tr>
    <tr>
      <td>Architecture design</td>
      <td>0</td>
      <td>+2</td>
    </tr>
    <tr>
      <td>Batch processing</td>
      <td>+2</td>
      <td>0</td>
    </tr>
    <tr>
      <td>Creative synthesis</td>
      <td>0</td>
      <td>+2</td>
    </tr>
    <tr>
      <td>Documentation</td>
      <td>+1</td>
      <td>+1</td>
    </tr>
  </tbody>
</table>

<p><strong>Score &gt; 3</strong>: Strong preference
<strong>Score 1-3</strong>: Moderate preference
<strong>Score &lt; 1</strong>: Consider alternative</p>

<hr />

<h2 id="cost-analysis">Cost Analysis</h2>

<h3 id="current-state-all-sonnet">Current State (All Sonnet)</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Average task: 5 agent calls × $3 per 1M input tokens
= $15 per 1M tokens

Daily volume (1000 tasks):
= $15,000 per million tokens
</code></pre></div></div>

<h3 id="optimized-hybrid">Optimized (Hybrid)</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Architecture tasks (30%): 3 Sonnet + 2 Haiku
Implementation tasks (50%): 1 Sonnet + 4 Haiku
Maintenance tasks (20%): 0 Sonnet + 5 Haiku

Weighted average:
= (0.3 × $9) + (0.5 × $3.80) + (0.2 × $0.80)
= $2.70 + $1.90 + $0.16
= $4.76 per task

Daily volume (1000 tasks):
= $4,760 per million tokens

Savings: 68% reduction
</code></pre></div></div>

<hr />

<h2 id="performance-metrics">Performance Metrics</h2>

<h3 id="latency-comparison">Latency Comparison</h3>

<table>
  <thead>
    <tr>
      <th>Agent Type</th>
      <th>Haiku P95</th>
      <th>Sonnet P95</th>
      <th>Improvement</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Code Generation</td>
      <td>1.2s</td>
      <td>4.8s</td>
      <td>4x faster</td>
    </tr>
    <tr>
      <td>Test Generation</td>
      <td>0.8s</td>
      <td>3.2s</td>
      <td>4x faster</td>
    </tr>
    <tr>
      <td>Documentation</td>
      <td>1.5s</td>
      <td>5.0s</td>
      <td>3.3x faster</td>
    </tr>
    <tr>
      <td>IaC Generation</td>
      <td>1.0s</td>
      <td>3.5s</td>
      <td>3.5x faster</td>
    </tr>
  </tbody>
</table>

<h3 id="quality-metrics">Quality Metrics</h3>

<table>
  <thead>
    <tr>
      <th>Agent Type</th>
      <th>Haiku Success</th>
      <th>Sonnet Success</th>
      <th>Delta</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Code Generation</td>
      <td>94%</td>
      <td>96%</td>
      <td>-2%</td>
    </tr>
    <tr>
      <td>Architecture</td>
      <td>78%</td>
      <td>94%</td>
      <td>-16% (use Sonnet)</td>
    </tr>
    <tr>
      <td>Test Generation</td>
      <td>92%</td>
      <td>93%</td>
      <td>-1%</td>
    </tr>
    <tr>
      <td>Security Audit</td>
      <td>82%</td>
      <td>95%</td>
      <td>-13% (use Sonnet)</td>
    </tr>
  </tbody>
</table>

<p><strong>Key Insight</strong>: Haiku within 2% for deterministic tasks, Sonnet critical for reasoning tasks</p>

<hr />

<h2 id="migration-plan">Migration Plan</h2>

<h3 id="phase-1-core-agents-week-1">Phase 1: Core Agents (Week 1)</h3>
<ul>
  <li>Update 10 highest-volume agents</li>
  <li>Deploy Haiku for code generation agents</li>
  <li>Monitor success rates and rollback if &lt; 90%</li>
</ul>

<h3 id="phase-2-testing--iac-week-2">Phase 2: Testing &amp; IaC (Week 2)</h3>
<ul>
  <li>Migrate test generation agents</li>
  <li>Migrate infrastructure agents</li>
  <li>Validate cost savings (target: 40%)</li>
</ul>

<h3 id="phase-3-documentation--tools-week-3">Phase 3: Documentation &amp; Tools (Week 3)</h3>
<ul>
  <li>Migrate documentation agents</li>
  <li>Migrate tooling agents</li>
  <li>Measure latency improvements (target: 3x)</li>
</ul>

<h3 id="phase-4-context-dependent-week-4">Phase 4: Context-Dependent (Week 4)</h3>
<ul>
  <li>Implement escalation logic</li>
  <li>Add smart routing based on task complexity</li>
  <li>Fine-tune thresholds</li>
</ul>

<hr />

<h2 id="monitoring--observability">Monitoring &amp; Observability</h2>

<h3 id="key-metrics">Key Metrics</h3>

<p><strong>Cost Metrics:</strong></p>
<ul>
  <li>Cost per agent call (by model)</li>
  <li>Daily/weekly cost trends</li>
  <li>Cost by agent category</li>
</ul>

<p><strong>Performance Metrics:</strong></p>
<ul>
  <li>P50, P95, P99 latency (by model)</li>
  <li>Success rate (by agent, by model)</li>
  <li>Escalation rate (context-dependent agents)</li>
</ul>

<p><strong>Quality Metrics:</strong></p>
<ul>
  <li>User satisfaction scores</li>
  <li>Correction/revision rates</li>
  <li>Fallback trigger frequency</li>
</ul>

<h3 id="alerts">Alerts</h3>

<p><strong>Cost Anomalies:</strong></p>
<ul>
  <li>Daily cost &gt; 120% of 7-day average</li>
  <li>Unexpected Sonnet usage spike</li>
</ul>

<p><strong>Performance Degradation:</strong></p>
<ul>
  <li>Success rate &lt; 85% for any agent</li>
  <li>P95 latency &gt; 2× baseline</li>
</ul>

<p><strong>Escalation Issues:</strong></p>
<ul>
  <li>Escalation rate &gt; 30% (may indicate wrong default)</li>
  <li>Fallback rate &gt; 10%</li>
</ul>

<hr />

<h2 id="best-practices">Best Practices</h2>

<ol>
  <li><strong>Default to Haiku</strong> for well-defined, deterministic tasks</li>
  <li><strong>Use Sonnet</strong> for novel problems, security, architecture</li>
  <li><strong>Implement escalation</strong> for borderline cases</li>
  <li><strong>Monitor metrics</strong> continuously for optimization</li>
  <li><strong>A/B test</strong> model changes before full rollout</li>
  <li><strong>Document reasoning</strong> in agent frontmatter</li>
  <li><strong>Review quarterly</strong> and adjust based on new model capabilities</li>
  <li><strong>Cost-quality trade-offs</strong> should favor quality for security/critical paths</li>
  <li><strong>Batch operations</strong> should heavily favor Haiku</li>
  <li><strong>User-facing analysis</strong> should use Sonnet for better explanations</li>
</ol>

<hr />

<h2 id="future-enhancements">Future Enhancements</h2>

<h3 id="smart-routing">Smart Routing</h3>
<ul>
  <li>Analyze task complexity before agent selection</li>
  <li>Route simple tasks to Haiku, complex to Sonnet</li>
  <li>Learn from user corrections</li>
</ul>

<h3 id="auto-escalation">Auto-Escalation</h3>
<ul>
  <li>Start with Haiku</li>
  <li>Escalate to Sonnet if:
    <ul>
      <li>Confidence score &lt; 0.7</li>
      <li>User provides corrective feedback</li>
      <li>Task complexity indicators detected</li>
    </ul>
  </li>
</ul>

<h3 id="cost-budgets">Cost Budgets</h3>
<ul>
  <li>Per-agent cost budgets</li>
  <li>Auto-throttle expensive operations</li>
  <li>User-configurable cost limits</li>
</ul>

<h3 id="performance-profiling">Performance Profiling</h3>
<ul>
  <li>Track which agents benefit most from Sonnet</li>
  <li>Identify over-powered agents (Sonnet where Haiku sufficient)</li>
  <li>Continuous optimization loop</li>
</ul>

<hr />

<h2 id="resources">Resources</h2>

<ul>
  <li><a href="https://docs.anthropic.com/en/docs/models-overview">Anthropic Model Documentation</a></li>
  <li><a href="https://docs.anthropic.com/en/docs/about-claude/models">Claude Sonnet vs Haiku Comparison</a></li>
  <li><a href="https://docs.anthropic.com/en/docs/about-claude/pricing">Cost Calculator</a></li>
  <li>Internal: <code class="language-plaintext highlighter-rouge">agents/dependencies.map</code> - Agent dependency graph</li>
  <li>Internal: <code class="language-plaintext highlighter-rouge">docs/agents.md</code> - Complete agent catalog</li>
</ul>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/claude-ctx-plugin/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Claude CTX Plugin</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Claude CTX Plugin</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Comprehensive context management plugin for Claude Code</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
